<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>pandas 基础命令速查表 | Bear's dream</title><meta name="description" content="pandas 基础命令速查表"><meta name="keywords" content="python,pandas,kesci"><meta name="author" content="supersheepbear"><meta name="copyright" content="supersheepbear"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon_1.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="p43hXBn3_dLvbyxUzx0eo5eYmj9OVYOV52pdrhBa2sw"><meta name="baidu-site-verification" content="EXLlfLv2pV"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="pandas 基础命令速查表"><meta name="twitter:description" content="pandas 基础命令速查表"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png"><meta property="og:type" content="article"><meta property="og:title" content="pandas 基础命令速查表"><meta property="og:url" content="https://yangxiongwiki.com/2020/01/14/python/kesci_notes/pandas%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%E8%A1%A8/"><meta property="og:site_name" content="Bear's dream"><meta property="og:description" content="pandas 基础命令速查表"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://yangxiongwiki.com/2020/01/14/python/kesci_notes/pandas%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%E8%A1%A8/"><link rel="prev" title="pandas datetime notes" href="https://yangxiongwiki.com/2020/01/15/python/basics/pandas_datetime_notes/"><link rel="next" title="windows_10_tricks.md" href="https://yangxiongwiki.com/2020/01/14/random_notes/windows_10_tricks/"><link rel="stylesheet" href="hfttps://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Bear's dream" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Bear's dream</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 音乐照片</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 学习计划</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200520153141.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">38</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">35</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">16</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 音乐照片</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 学习计划</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据导入"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">数据导入</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据导出"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">数据导出</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#创建测试对象"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">创建测试对象</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#numpy-array-创建"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">numpy array 创建</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#list-创建"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">list 创建</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#用普通字典创建"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">用普通字典创建</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#用orderdict创建"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">用orderdict创建</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据的查看与检查"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">数据的查看与检查</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据描述"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">数据描述</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#单列数值次数统计"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">单列数值次数统计</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查询数据框-Data-Frame-中每个列的独特数据值出现次数统计"><span class="toc_mobile_items-number">4.3.</span> <span class="toc_mobile_items-text">查询数据框 (Data Frame) 中每个列的独特数据值出现次数统计</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#分类计数"><span class="toc_mobile_items-number">4.4.</span> <span class="toc_mobile_items-text">分类计数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#样本类型个数"><span class="toc_mobile_items-number">4.5.</span> <span class="toc_mobile_items-text">样本类型个数</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据的选取"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">数据的选取</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据的清洗"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">数据的清洗</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据列的重命名"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text">数据列的重命名</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#数据行的重命名"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text">数据行的重命名</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用特定列作为行索引"><span class="toc_mobile_items-number">6.3.</span> <span class="toc_mobile_items-text">使用特定列作为行索引</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#检查空值"><span class="toc_mobile_items-number">6.4.</span> <span class="toc_mobile_items-text">检查空值</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#移除空值行"><span class="toc_mobile_items-number">6.5.</span> <span class="toc_mobile_items-text">移除空值行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#移除空值列"><span class="toc_mobile_items-number">6.6.</span> <span class="toc_mobile_items-text">移除空值列</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#移除超过n个空值的列"><span class="toc_mobile_items-number">6.7.</span> <span class="toc_mobile_items-text">移除超过n个空值的列</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#填充空值为常数"><span class="toc_mobile_items-number">6.8.</span> <span class="toc_mobile_items-text">填充空值为常数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#填充空值为均值"><span class="toc_mobile_items-number">6.9.</span> <span class="toc_mobile_items-text">填充空值为均值</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#转换数据类型"><span class="toc_mobile_items-number">6.10.</span> <span class="toc_mobile_items-text">转换数据类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#替换特定数据"><span class="toc_mobile_items-number">6.11.</span> <span class="toc_mobile_items-text">替换特定数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#删除列或者行"><span class="toc_mobile_items-number">6.12.</span> <span class="toc_mobile_items-text">删除列或者行</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据过滤-排序-分组"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">数据过滤,排序,分组</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#过滤"><span class="toc_mobile_items-number">7.1.</span> <span class="toc_mobile_items-text">过滤</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#排序"><span class="toc_mobile_items-number">7.2.</span> <span class="toc_mobile_items-text">排序</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#分组"><span class="toc_mobile_items-number">7.3.</span> <span class="toc_mobile_items-text">分组</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#透视表"><span class="toc_mobile_items-number">7.4.</span> <span class="toc_mobile_items-text">透视表</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#对数据使用函数"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">对数据使用函数</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#对每一列使用函数"><span class="toc_mobile_items-number">8.1.</span> <span class="toc_mobile_items-text">对每一列使用函数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#对每一行使用函数"><span class="toc_mobile_items-number">8.2.</span> <span class="toc_mobile_items-text">对每一行使用函数</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据的连接-组合-插入"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text">数据的连接, 组合, 插入</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#末尾拼接两个dataframe"><span class="toc_mobile_items-number">9.1.</span> <span class="toc_mobile_items-text">末尾拼接两个dataframe</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#按loc末尾直接加入行或列"><span class="toc_mobile_items-number">9.2.</span> <span class="toc_mobile_items-text">按loc末尾直接加入行或列</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#两个dafaframe组合"><span class="toc_mobile_items-number">9.3.</span> <span class="toc_mobile_items-text">两个dafaframe组合</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#插入特定行"><span class="toc_mobile_items-number">9.4.</span> <span class="toc_mobile_items-text">插入特定行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#插入特定列"><span class="toc_mobile_items-number">9.5.</span> <span class="toc_mobile_items-text">插入特定列</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#利用groupby和条件增加列"><span class="toc_mobile_items-number">9.6.</span> <span class="toc_mobile_items-text">利用groupby和条件增加列</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#利用apply函数增加列"><span class="toc_mobile_items-number">9.7.</span> <span class="toc_mobile_items-text">利用apply函数增加列</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#database式merge数据"><span class="toc_mobile_items-number">9.8.</span> <span class="toc_mobile_items-text">database式merge数据</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据统计"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text">数据统计</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#基本统计"><span class="toc_mobile_items-number">10.1.</span> <span class="toc_mobile_items-text">基本统计</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#最大值索引"><span class="toc_mobile_items-number">10.2.</span> <span class="toc_mobile_items-text">最大值索引</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#时间序列"><span class="toc_mobile_items-number">11.</span> <span class="toc_mobile_items-text">时间序列</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#构建时间索引"><span class="toc_mobile_items-number">11.1.</span> <span class="toc_mobile_items-text">构建时间索引</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#转换时间格式"><span class="toc_mobile_items-number">11.2.</span> <span class="toc_mobile_items-text">转换时间格式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#时间格式采样"><span class="toc_mobile_items-number">11.3.</span> <span class="toc_mobile_items-text">时间格式采样</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据导入"><span class="toc-number">1.</span> <span class="toc-text">数据导入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据导出"><span class="toc-number">2.</span> <span class="toc-text">数据导出</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建测试对象"><span class="toc-number">3.</span> <span class="toc-text">创建测试对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#numpy-array-创建"><span class="toc-number">3.1.</span> <span class="toc-text">numpy array 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#list-创建"><span class="toc-number">3.2.</span> <span class="toc-text">list 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用普通字典创建"><span class="toc-number">3.3.</span> <span class="toc-text">用普通字典创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#用orderdict创建"><span class="toc-number">3.4.</span> <span class="toc-text">用orderdict创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据的查看与检查"><span class="toc-number">4.</span> <span class="toc-text">数据的查看与检查</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据描述"><span class="toc-number">4.1.</span> <span class="toc-text">数据描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单列数值次数统计"><span class="toc-number">4.2.</span> <span class="toc-text">单列数值次数统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询数据框-Data-Frame-中每个列的独特数据值出现次数统计"><span class="toc-number">4.3.</span> <span class="toc-text">查询数据框 (Data Frame) 中每个列的独特数据值出现次数统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分类计数"><span class="toc-number">4.4.</span> <span class="toc-text">分类计数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#样本类型个数"><span class="toc-number">4.5.</span> <span class="toc-text">样本类型个数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据的选取"><span class="toc-number">5.</span> <span class="toc-text">数据的选取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据的清洗"><span class="toc-number">6.</span> <span class="toc-text">数据的清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据列的重命名"><span class="toc-number">6.1.</span> <span class="toc-text">数据列的重命名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据行的重命名"><span class="toc-number">6.2.</span> <span class="toc-text">数据行的重命名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用特定列作为行索引"><span class="toc-number">6.3.</span> <span class="toc-text">使用特定列作为行索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#检查空值"><span class="toc-number">6.4.</span> <span class="toc-text">检查空值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移除空值行"><span class="toc-number">6.5.</span> <span class="toc-text">移除空值行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移除空值列"><span class="toc-number">6.6.</span> <span class="toc-text">移除空值列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移除超过n个空值的列"><span class="toc-number">6.7.</span> <span class="toc-text">移除超过n个空值的列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#填充空值为常数"><span class="toc-number">6.8.</span> <span class="toc-text">填充空值为常数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#填充空值为均值"><span class="toc-number">6.9.</span> <span class="toc-text">填充空值为均值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#转换数据类型"><span class="toc-number">6.10.</span> <span class="toc-text">转换数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#替换特定数据"><span class="toc-number">6.11.</span> <span class="toc-text">替换特定数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除列或者行"><span class="toc-number">6.12.</span> <span class="toc-text">删除列或者行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据过滤-排序-分组"><span class="toc-number">7.</span> <span class="toc-text">数据过滤,排序,分组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#过滤"><span class="toc-number">7.1.</span> <span class="toc-text">过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#排序"><span class="toc-number">7.2.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分组"><span class="toc-number">7.3.</span> <span class="toc-text">分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#透视表"><span class="toc-number">7.4.</span> <span class="toc-text">透视表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对数据使用函数"><span class="toc-number">8.</span> <span class="toc-text">对数据使用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#对每一列使用函数"><span class="toc-number">8.1.</span> <span class="toc-text">对每一列使用函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对每一行使用函数"><span class="toc-number">8.2.</span> <span class="toc-text">对每一行使用函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据的连接-组合-插入"><span class="toc-number">9.</span> <span class="toc-text">数据的连接, 组合, 插入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#末尾拼接两个dataframe"><span class="toc-number">9.1.</span> <span class="toc-text">末尾拼接两个dataframe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#按loc末尾直接加入行或列"><span class="toc-number">9.2.</span> <span class="toc-text">按loc末尾直接加入行或列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#两个dafaframe组合"><span class="toc-number">9.3.</span> <span class="toc-text">两个dafaframe组合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插入特定行"><span class="toc-number">9.4.</span> <span class="toc-text">插入特定行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插入特定列"><span class="toc-number">9.5.</span> <span class="toc-text">插入特定列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#利用groupby和条件增加列"><span class="toc-number">9.6.</span> <span class="toc-text">利用groupby和条件增加列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#利用apply函数增加列"><span class="toc-number">9.7.</span> <span class="toc-text">利用apply函数增加列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#database式merge数据"><span class="toc-number">9.8.</span> <span class="toc-text">database式merge数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据统计"><span class="toc-number">10.</span> <span class="toc-text">数据统计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本统计"><span class="toc-number">10.1.</span> <span class="toc-text">基本统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最大值索引"><span class="toc-number">10.2.</span> <span class="toc-text">最大值索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#时间序列"><span class="toc-number">11.</span> <span class="toc-text">时间序列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#构建时间索引"><span class="toc-number">11.1.</span> <span class="toc-text">构建时间索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#转换时间格式"><span class="toc-number">11.2.</span> <span class="toc-text">转换时间格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间格式采样"><span class="toc-number">11.3.</span> <span class="toc-text">时间格式采样</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png)"><div id="post-info"><div id="post-title"><div class="posttitle">pandas 基础命令速查表</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-01-14<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-02-02</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/python/">python</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/python/kesci-notes/">kesci_notes</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2020/01/14/python/kesci_notes/pandas%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%E8%A1%A8/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/01/14/python/kesci_notes/pandas%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%E8%A1%A8/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><font size="72">pandas 基础命令复习</font>

<p>此notebook为kesci.com的pandas基础命令速查表项目。<br>网址链接：<br><a href="https://www.kesci.com/home/project/59e389b54663f7655c48f518" target="_blank" rel="external nofollow noopener noreferrer">pandas基础命令速查表</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure></div>
<h2 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(filename) <span class="comment"># 导入csv格式文件中的数据</span></span><br><span class="line">pd.read_table(filename) <span class="comment"># 导入有分隔符的文本 (如TSV) 中的数据</span></span><br><span class="line">pd.read_excel(filename) <span class="comment"># 导入Excel格式文件中的数据</span></span><br><span class="line">pd.read_sql(query, connection_object) <span class="comment"># 导入SQL数据表/数据库中的数据</span></span><br><span class="line">pd.read_json(json_string) <span class="comment"># 导入JSON格式的字符，URL地址或者文件中的数据</span></span><br><span class="line">pd.read_html(url) <span class="comment"># 导入经过解析的URL地址中包含的数据框 (DataFrame) 数据</span></span><br><span class="line">pd.read_clipmboard() <span class="comment"># 导入系统粘贴板里面的数据</span></span><br><span class="line">pd.DataFrame(dict)  <span class="comment"># 导入Python字典 (dict) 里面的数据，其中key是数据框的表头，value是数据框的内容。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">parse_dates = [[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>]]可以合并读入数据的前三列变成一个datetime的序列</span><br></pre></td></tr></table></figure></div>
<h2 id="数据导出"><a href="#数据导出" class="headerlink" title="数据导出"></a>数据导出</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(filename) <span class="comment"># 将数据框 (DataFrame)中的数据导入csv格式的文件中</span></span><br><span class="line">df.to_excel(filename) <span class="comment"># 将数据框 (DataFrame)中的数据导入Excel格式的文件中</span></span><br><span class="line">df.to_sql(table_name,connection_object) <span class="comment"># 将数据框 (DataFrame)中的数据导入SQL数据表/数据库中</span></span><br><span class="line">df.to_json(filename) <span class="comment"># 将数据框 (DataFrame)中的数据导入JSON格式的文件中</span></span><br></pre></td></tr></table></figure></div>
<h2 id="创建测试对象"><a href="#创建测试对象" class="headerlink" title="创建测试对象"></a>创建测试对象</h2><h3 id="numpy-array-创建"><a href="#numpy-array-创建" class="headerlink" title="numpy array 创建"></a>numpy array 创建</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.DataFrame(np.random.rand(<span class="number">10</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.585777</td>
      <td>0.433112</td>
      <td>0.338235</td>
      <td>0.291173</td>
      <td>0.031913</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.624464</td>
      <td>0.895368</td>
      <td>0.292560</td>
      <td>0.080429</td>
      <td>0.495787</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.816629</td>
      <td>0.563991</td>
      <td>0.189032</td>
      <td>0.114238</td>
      <td>0.524798</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.065594</td>
      <td>0.794394</td>
      <td>0.699740</td>
      <td>0.413209</td>
      <td>0.630886</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.001313</td>
      <td>0.100108</td>
      <td>0.882507</td>
      <td>0.498680</td>
      <td>0.108653</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.777563</td>
      <td>0.892090</td>
      <td>0.950747</td>
      <td>0.869066</td>
      <td>0.405635</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.597492</td>
      <td>0.794607</td>
      <td>0.345172</td>
      <td>0.685253</td>
      <td>0.434808</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.263838</td>
      <td>0.649635</td>
      <td>0.828545</td>
      <td>0.859189</td>
      <td>0.090903</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.074650</td>
      <td>0.448147</td>
      <td>0.905926</td>
      <td>0.283079</td>
      <td>0.618817</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.117861</td>
      <td>0.120424</td>
      <td>0.063917</td>
      <td>0.605063</td>
      <td>0.954940</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="list-创建"><a href="#list-创建" class="headerlink" title="list 创建"></a>list 创建</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_list = [<span class="string">'Kesci'</span>,<span class="number">100</span>,<span class="string">'欢迎来到科赛网'</span>]</span><br><span class="line">pd.Series(my_list)</span><br></pre></td></tr></table></figure></div>
<pre><code>0      Kesci
1        100
2    欢迎来到科赛网
dtype: object
</code></pre><p>添加一个日期索引</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line">df.index = pd.date_range(<span class="string">'2017/1/1'</span>, periods=df.shape[<span class="number">0</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="用普通字典创建"><a href="#用普通字典创建" class="headerlink" title="用普通字典创建"></a>用普通字典创建</h3><p>注意此法不能保证顺序</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">new_dict = &#123;&#125;</span><br><span class="line">new_dict[<span class="string">'foo'</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line">new_dict[<span class="string">'bar'</span>] = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">df = pd.DataFrame(new_dict)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="用orderdict创建"><a href="#用orderdict创建" class="headerlink" title="用orderdict创建"></a>用orderdict创建</h3><p>此法一定能够按照顺序创建</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line">order_dict = OrderedDict()</span><br><span class="line">order_dict[<span class="string">'foo'</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">order_dict[<span class="string">'bar'</span>] = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">order_dict</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(order_dict)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="数据的查看与检查"><a href="#数据的查看与检查" class="headerlink" title="数据的查看与检查"></a>数据的查看与检查</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.933522</td>
      <td>0.245400</td>
      <td>0.293748</td>
      <td>0.723707</td>
      <td>0.844672</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.583137</td>
      <td>0.717747</td>
      <td>0.409480</td>
      <td>0.489166</td>
      <td>0.788739</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.234310</td>
      <td>0.287521</td>
      <td>0.574982</td>
      <td>0.845111</td>
      <td>0.817525</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.tail(<span class="number">3</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-08</th>
      <td>0.551200</td>
      <td>0.934601</td>
      <td>0.933677</td>
      <td>0.792482</td>
      <td>0.532230</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.126025</td>
      <td>0.033953</td>
      <td>0.284972</td>
      <td>0.715794</td>
      <td>0.083033</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.138878</td>
      <td>0.834870</td>
      <td>0.065170</td>
      <td>0.289762</td>
      <td>0.456829</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure></div>
<pre><code>(10, 5)
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.info()</span><br></pre></td></tr></table></figure></div>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 10 entries, 2017-01-01 to 2017-01-10
Freq: D
Data columns (total 5 columns):
0    10 non-null float64
1    10 non-null float64
2    10 non-null float64
3    10 non-null float64
4    10 non-null float64
dtypes: float64(5)
memory usage: 800.0 bytes
</code></pre><h3 id="数据描述"><a href="#数据描述" class="headerlink" title="数据描述"></a>数据描述</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.497133</td>
      <td>0.390297</td>
      <td>0.444135</td>
      <td>0.700152</td>
      <td>0.542396</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.290880</td>
      <td>0.333661</td>
      <td>0.281356</td>
      <td>0.193923</td>
      <td>0.272418</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.126025</td>
      <td>0.033116</td>
      <td>0.065170</td>
      <td>0.289762</td>
      <td>0.083033</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.277898</td>
      <td>0.142655</td>
      <td>0.287166</td>
      <td>0.649304</td>
      <td>0.376368</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.492851</td>
      <td>0.266461</td>
      <td>0.378556</td>
      <td>0.719751</td>
      <td>0.516397</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.608873</td>
      <td>0.659798</td>
      <td>0.637238</td>
      <td>0.831953</td>
      <td>0.810329</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.943647</td>
      <td>0.934601</td>
      <td>0.933677</td>
      <td>0.921472</td>
      <td>0.844672</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="单列数值次数统计"><a href="#单列数值次数统计" class="headerlink" title="单列数值次数统计"></a>单列数值次数统计</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="number">0</span>].value_counts(dropna=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0.943647    1
0.617452    1
0.583137    1
0.551200    1
0.234310    1
0.933522    1
0.138878    1
0.408662    1
0.126025    1
0.434502    1
Name: 0, dtype: int64
</code></pre><h3 id="查询数据框-Data-Frame-中每个列的独特数据值出现次数统计"><a href="#查询数据框-Data-Frame-中每个列的独特数据值出现次数统计" class="headerlink" title="查询数据框 (Data Frame) 中每个列的独特数据值出现次数统计"></a>查询数据框 (Data Frame) 中每个列的独特数据值出现次数统计</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(pd.Series.value_counts)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.033116</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.033953</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.065170</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.083033</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.114544</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.120403</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.126025</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.138878</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.209412</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.223586</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.234310</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.245400</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.284972</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.287521</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.289762</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.293748</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.347632</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.349548</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.408662</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.409480</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.434502</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.456829</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.485952</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.489166</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.500563</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.532230</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.551200</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.574982</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.583137</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.617452</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.639218</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.657990</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.679562</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.715794</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.717747</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.723707</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.759157</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.788739</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.792482</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.817525</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.827238</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.834870</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.844672</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0.845111</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.905241</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.921472</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.933522</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.933677</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.934601</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.943647</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="分类计数"><a href="#分类计数" class="headerlink" title="分类计数"></a>分类计数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line">order_dict = OrderedDict()</span><br><span class="line">order_dict[<span class="string">'foo'</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">order_dict[<span class="string">'bar'</span>] = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>]</span><br><span class="line">df = pd.DataFrame(order_dict)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<p>样本分类统计个数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">'foo'</span>].value_counts().head(<span class="number">20</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>3    2
1    2
2    1
Name: foo, dtype: int64
</code></pre><h3 id="样本类型个数"><a href="#样本类型个数" class="headerlink" title="样本类型个数"></a>样本类型个数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">'foo'</span>].nunique()</span><br></pre></td></tr></table></figure></div>
<pre><code>3
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">'foo'</span>].value_counts().shape[<span class="number">0</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>3
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(df.loc[:, <span class="string">'foo'</span>].unique())</span><br></pre></td></tr></table></figure></div>
<pre><code>3
</code></pre><h2 id="数据的选取"><a href="#数据的选取" class="headerlink" title="数据的选取"></a>数据的选取</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.933522</td>
      <td>0.245400</td>
      <td>0.293748</td>
      <td>0.723707</td>
      <td>0.844672</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.583137</td>
      <td>0.717747</td>
      <td>0.409480</td>
      <td>0.489166</td>
      <td>0.788739</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.234310</td>
      <td>0.287521</td>
      <td>0.574982</td>
      <td>0.845111</td>
      <td>0.817525</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.434502</td>
      <td>0.120403</td>
      <td>0.347632</td>
      <td>0.639218</td>
      <td>0.223586</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.408662</td>
      <td>0.209412</td>
      <td>0.657990</td>
      <td>0.679562</td>
      <td>0.349548</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.617452</td>
      <td>0.033116</td>
      <td>0.759157</td>
      <td>0.921472</td>
      <td>0.827238</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.943647</td>
      <td>0.485952</td>
      <td>0.114544</td>
      <td>0.905241</td>
      <td>0.500563</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.551200</td>
      <td>0.934601</td>
      <td>0.933677</td>
      <td>0.792482</td>
      <td>0.532230</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.126025</td>
      <td>0.033953</td>
      <td>0.284972</td>
      <td>0.715794</td>
      <td>0.083033</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.138878</td>
      <td>0.834870</td>
      <td>0.065170</td>
      <td>0.289762</td>
      <td>0.456829</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">'2017-01-01'</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>0.24540013304048203
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.ix[<span class="string">'2017-01-01'</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>C:\Users\yxion\Anaconda3\envs\py37\lib\site-packages\ipykernel_launcher.py:1: FutureWarning: 
.ix is deprecated. Please use
.loc for label based indexing or
.iloc for positional indexing

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#ix-indexer-is-deprecated
  &quot;&quot;&quot;Entry point for launching an IPython kernel.





0.24540013304048203
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.iloc[<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>0.24540013304048203
</code></pre><h2 id="数据的清洗"><a href="#数据的清洗" class="headerlink" title="数据的清洗"></a>数据的清洗</h2><h3 id="数据列的重命名"><a href="#数据列的重命名" class="headerlink" title="数据列的重命名"></a>数据列的重命名</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>]</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<p>df.rename不会替换原dataframe</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=<span class="keyword">lambda</span> x: x+<span class="string">'changed'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>achanged</th>
      <th>bchanged</th>
      <th>cchanged</th>
      <th>dchanged</th>
      <th>echanged</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;<span class="string">'a'</span>:<span class="string">'newA'</span>,<span class="string">'c'</span>:<span class="string">'newC'</span>&#125;)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>newA</th>
      <th>b</th>
      <th>newC</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="数据行的重命名"><a href="#数据行的重命名" class="headerlink" title="数据行的重命名"></a>数据行的重命名</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.index = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'j'</span>]</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>g</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>i</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>j</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="使用特定列作为行索引"><a href="#使用特定列作为行索引" class="headerlink" title="使用特定列作为行索引"></a>使用特定列作为行索引</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>f</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>g</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>i</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>j</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<p>例如把a这列变成index</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1 = df.set_index(<span class="string">'a'</span>)</span><br><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
    <tr>
      <th>a</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.828249</th>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>0.566537</th>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>0.468922</th>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>0.467536</th>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>0.599552</th>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>0.946407</th>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>0.791554</th>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>0.052724</th>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>0.492461</th>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>0.562764</th>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<p>还原index, 把index列变回数据</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df2 = df1.reset_index()</span><br><span class="line">df2</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="检查空值"><a href="#检查空值" class="headerlink" title="检查空值"></a>检查空值</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:np.array([<span class="number">1</span>,np.nan,<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>,np.nan]),</span><br><span class="line">                 <span class="string">'B'</span>:np.array([np.nan,<span class="number">4</span>,np.nan,<span class="number">5</span>,<span class="number">9</span>,np.nan]),</span><br><span class="line">                  <span class="string">'C'</span>:<span class="string">'foo'</span>&#125;)</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>5.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>9.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.isnull(df)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.notnull(df)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="移除空值行"><a href="#移除空值行" class="headerlink" title="移除空值行"></a>移除空值行</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna()</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>5.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>9.0</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="移除空值列"><a href="#移除空值列" class="headerlink" title="移除空值列"></a>移除空值列</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>foo</td>
    </tr>
    <tr>
      <th>5</th>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="移除超过n个空值的列"><a href="#移除超过n个空值的列" class="headerlink" title="移除超过n个空值的列"></a>移除超过n个空值的列</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(axis=<span class="number">1</span>,thresh=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>5.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>9.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="填充空值为常数"><a href="#填充空值为常数" class="headerlink" title="填充空值为常数"></a>填充空值为常数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.fillna(<span class="string">'Test'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Test</td>
      <td>4</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>5</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>9</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Test</td>
      <td>Test</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="填充空值为均值"><a href="#填充空值为均值" class="headerlink" title="填充空值为均值"></a>填充空值为均值</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.fillna(df.mean())</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>6.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>5.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
      <td>9.0</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.0</td>
      <td>6.0</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="转换数据类型"><a href="#转换数据类型" class="headerlink" title="转换数据类型"></a>转换数据类型</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[:, <span class="string">'A'</span>].astype(np.float64)</span><br></pre></td></tr></table></figure></div>
<pre><code>0    1.0
1    NaN
2    2.0
3    3.0
4    6.0
5    NaN
Name: A, dtype: float64
</code></pre><h3 id="替换特定数据"><a href="#替换特定数据" class="headerlink" title="替换特定数据"></a>替换特定数据</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan,<span class="number">7</span>,<span class="number">9</span>,<span class="number">9</span>])</span><br><span class="line">s.replace(<span class="number">1</span>, <span class="string">'one'</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0    one
1      3
2      5
3    NaN
4      7
5      9
6      9
dtype: object
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s</span><br></pre></td></tr></table></figure></div>
<pre><code>0    1.0
1    3.0
2    5.0
3    NaN
4    7.0
5    9.0
6    9.0
dtype: float64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.replace([<span class="number">1</span>,<span class="number">3</span>],[<span class="string">'one'</span>,<span class="string">'three'</span>])</span><br></pre></td></tr></table></figure></div>
<pre><code>0      one
1    three
2        5
3      NaN
4        7
5        9
6        9
dtype: object
</code></pre><h3 id="删除列或者行"><a href="#删除列或者行" class="headerlink" title="删除列或者行"></a>删除列或者行</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line">order_dict = OrderedDict()</span><br><span class="line">order_dict[<span class="string">'foo'</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">order_dict[<span class="string">'bar'</span>] = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">order_dict</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(order_dict)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(<span class="string">'foo'</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(<span class="number">0</span>, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="数据过滤-排序-分组"><a href="#数据过滤-排序-分组" class="headerlink" title="数据过滤,排序,分组"></a>数据过滤,排序,分组</h2><h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line">df.index = pd.date_range(<span class="string">'2017/1/1'</span>, periods=df.shape[<span class="number">0</span>])</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-01</th>
      <td>0.462320</td>
      <td>0.641626</td>
      <td>0.783622</td>
      <td>0.405599</td>
      <td>0.086237</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>0.860784</td>
      <td>0.463871</td>
      <td>0.671531</td>
      <td>0.276455</td>
      <td>0.033289</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.980626</td>
      <td>0.996484</td>
      <td>0.772686</td>
      <td>0.711433</td>
      <td>0.129981</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.863321</td>
      <td>0.884043</td>
      <td>0.182961</td>
      <td>0.889572</td>
      <td>0.916571</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>0.111071</td>
      <td>0.927398</td>
      <td>0.636951</td>
      <td>0.709890</td>
      <td>0.589606</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>0.115526</td>
      <td>0.935115</td>
      <td>0.506834</td>
      <td>0.305816</td>
      <td>0.235401</td>
    </tr>
    <tr>
      <th>2017-01-07</th>
      <td>0.498320</td>
      <td>0.330181</td>
      <td>0.905941</td>
      <td>0.135436</td>
      <td>0.360116</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.730144</td>
      <td>0.045433</td>
      <td>0.698341</td>
      <td>0.929830</td>
      <td>0.060545</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.889181</td>
      <td>0.189442</td>
      <td>0.832306</td>
      <td>0.776265</td>
      <td>0.129116</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.709422</td>
      <td>0.344869</td>
      <td>0.889001</td>
      <td>0.007639</td>
      <td>0.354979</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.loc[df[<span class="number">0</span>]&gt;<span class="number">0.5</span>]</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-02</th>
      <td>0.860784</td>
      <td>0.463871</td>
      <td>0.671531</td>
      <td>0.276455</td>
      <td>0.033289</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.980626</td>
      <td>0.996484</td>
      <td>0.772686</td>
      <td>0.711433</td>
      <td>0.129981</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.863321</td>
      <td>0.884043</td>
      <td>0.182961</td>
      <td>0.889572</td>
      <td>0.916571</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.730144</td>
      <td>0.045433</td>
      <td>0.698341</td>
      <td>0.929830</td>
      <td>0.060545</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.889181</td>
      <td>0.189442</td>
      <td>0.832306</td>
      <td>0.776265</td>
      <td>0.129116</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.709422</td>
      <td>0.344869</td>
      <td>0.889001</td>
      <td>0.007639</td>
      <td>0.354979</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[df[<span class="number">0</span>]&gt;<span class="number">0.5</span>]</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-02</th>
      <td>0.860784</td>
      <td>0.463871</td>
      <td>0.671531</td>
      <td>0.276455</td>
      <td>0.033289</td>
    </tr>
    <tr>
      <th>2017-01-03</th>
      <td>0.980626</td>
      <td>0.996484</td>
      <td>0.772686</td>
      <td>0.711433</td>
      <td>0.129981</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.863321</td>
      <td>0.884043</td>
      <td>0.182961</td>
      <td>0.889572</td>
      <td>0.916571</td>
    </tr>
    <tr>
      <th>2017-01-08</th>
      <td>0.730144</td>
      <td>0.045433</td>
      <td>0.698341</td>
      <td>0.929830</td>
      <td>0.060545</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>0.889181</td>
      <td>0.189442</td>
      <td>0.832306</td>
      <td>0.776265</td>
      <td>0.129116</td>
    </tr>
    <tr>
      <th>2017-01-10</th>
      <td>0.709422</td>
      <td>0.344869</td>
      <td>0.889001</td>
      <td>0.007639</td>
      <td>0.354979</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[(df[<span class="number">0</span>]&gt;<span class="number">0.5</span>) &amp; (df[<span class="number">1</span>]&gt;<span class="number">0.5</span>)]</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-03</th>
      <td>0.980626</td>
      <td>0.996484</td>
      <td>0.772686</td>
      <td>0.711433</td>
      <td>0.129981</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>0.863321</td>
      <td>0.884043</td>
      <td>0.182961</td>
      <td>0.889572</td>
      <td>0.916571</td>
    </tr>
  </tbody>
</table>
</div>
<p>isin 的用法</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line">order_dict = OrderedDict()</span><br><span class="line">order_dict[<span class="string">'foo'</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">order_dict[<span class="string">'bar'</span>] = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">order_dict</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(order_dict)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df.loc[df.loc[:,<span class="string">'foo'</span>].isin([<span class="number">1</span>,<span class="number">2</span>]),<span class="string">'foo'</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>407 µs ± 7.45 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df.loc[df.foo.isin([<span class="number">1</span>,<span class="number">2</span>]),<span class="string">'foo'</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>375 µs ± 2.49 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%timeit df[df.foo.isin([<span class="number">1</span>,<span class="number">2</span>])].foo</span><br></pre></td></tr></table></figure></div>
<pre><code>523 µs ± 14.3 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre><h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>单列</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values(<span class="string">'a'</span>,ascending=<span class="literal">False</span>, na_position=<span class="string">'first'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>f</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>a</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>g</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>j</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
    <tr>
      <th>i</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
  </tbody>
</table>
</div>
<p>同时排序两列, 第一列先排</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values([<span class="string">'a'</span>, <span class="string">'b'</span>],ascending=[<span class="literal">False</span>,<span class="literal">False</span>])</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>f</th>
      <td>0.946407</td>
      <td>0.780112</td>
      <td>0.965793</td>
      <td>0.743042</td>
      <td>0.613386</td>
    </tr>
    <tr>
      <th>a</th>
      <td>0.828249</td>
      <td>0.792735</td>
      <td>0.512458</td>
      <td>0.961731</td>
      <td>0.917472</td>
    </tr>
    <tr>
      <th>g</th>
      <td>0.791554</td>
      <td>0.015501</td>
      <td>0.500903</td>
      <td>0.797965</td>
      <td>0.856116</td>
    </tr>
    <tr>
      <th>e</th>
      <td>0.599552</td>
      <td>0.123519</td>
      <td>0.814959</td>
      <td>0.329789</td>
      <td>0.696340</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.566537</td>
      <td>0.754457</td>
      <td>0.235026</td>
      <td>0.795147</td>
      <td>0.245506</td>
    </tr>
    <tr>
      <th>j</th>
      <td>0.562764</td>
      <td>0.952519</td>
      <td>0.256441</td>
      <td>0.942915</td>
      <td>0.152228</td>
    </tr>
    <tr>
      <th>i</th>
      <td>0.492461</td>
      <td>0.140432</td>
      <td>0.316593</td>
      <td>0.727536</td>
      <td>0.958459</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.468922</td>
      <td>0.852834</td>
      <td>0.549959</td>
      <td>0.124779</td>
      <td>0.219038</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.467536</td>
      <td>0.482505</td>
      <td>0.238425</td>
      <td>0.604942</td>
      <td>0.921739</td>
    </tr>
    <tr>
      <th>h</th>
      <td>0.052724</td>
      <td>0.335682</td>
      <td>0.253801</td>
      <td>0.277599</td>
      <td>0.525408</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p>类似于excel pivot table的一些功能</p>
<p>单列</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:np.array([<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'bar'</span>,<span class="string">'bar'</span>]),</span><br><span class="line">      <span class="string">'B'</span>:np.array([<span class="string">'one'</span>,<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'three'</span>]),</span><br><span class="line">     <span class="string">'C'</span>:np.array([<span class="string">'small'</span>,<span class="string">'medium'</span>,<span class="string">'large'</span>,<span class="string">'large'</span>,<span class="string">'small'</span>,<span class="string">'small'</span>]),</span><br><span class="line">     <span class="string">'D'</span>:np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>])&#125;)</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>small</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>medium</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'C'</span>).count()</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>D</th>
    </tr>
    <tr>
      <th>C</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>large</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>small</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'B'</span>,<span class="string">'C'</span>]).mean()</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>D</th>
    </tr>
    <tr>
      <th>B</th>
      <th>C</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">one</th>
      <th>medium</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>small</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>three</th>
      <th>small</th>
      <td>4.0</td>
    </tr>
    <tr>
      <th>two</th>
      <th>large</th>
      <td>2.5</td>
    </tr>
  </tbody>
</table>
</div>
<p>按照列B对数据框df做分组处理后，返回对应的D的平均值</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'B'</span>)[<span class="string">'D'</span>].mean()</span><br></pre></td></tr></table></figure></div>
<pre><code>B
one      1.5
three    4.0
two      2.5
Name: D, dtype: float64
</code></pre><p>自定义函数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'C'</span>).agg(np.mean)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
    </tr>
    <tr>
      <th>C</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>large</th>
      <td>2.5</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>small</th>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
<p>官方相同效果函数如下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'C'</span>).mean()</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
    </tr>
    <tr>
      <th>C</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>large</th>
      <td>2.5</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>small</th>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
<p>多组同时搞事</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'C'</span>).agg(&#123;<span class="string">'A'</span>:<span class="string">'describe'</span>, <span class="string">'B'</span>:<span class="string">'sum'</span>&#125;)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">A</th>
      <th>B</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
      <th>B</th>
    </tr>
    <tr>
      <th>C</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>large</th>
      <td>2</td>
      <td>1</td>
      <td>foo</td>
      <td>2</td>
      <td>twotwo</td>
    </tr>
    <tr>
      <th>medium</th>
      <td>1</td>
      <td>1</td>
      <td>foo</td>
      <td>1</td>
      <td>one</td>
    </tr>
    <tr>
      <th>small</th>
      <td>3</td>
      <td>2</td>
      <td>bar</td>
      <td>2</td>
      <td>onethreethree</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="透视表"><a href="#透视表" class="headerlink" title="透视表"></a>透视表</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:np.array([<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'bar'</span>,<span class="string">'bar'</span>]),</span><br><span class="line">      <span class="string">'B'</span>:np.array([<span class="string">'one'</span>,<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'three'</span>]),</span><br><span class="line">     <span class="string">'C'</span>:np.array([<span class="string">'small'</span>,<span class="string">'medium'</span>,<span class="string">'large'</span>,<span class="string">'large'</span>,<span class="string">'small'</span>,<span class="string">'small'</span>]),</span><br><span class="line">     <span class="string">'D'</span>:np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>])&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>small</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>medium</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.pivot_table(df,index=[<span class="string">'A'</span>,<span class="string">'B'</span>],</span><br><span class="line">               columns=[<span class="string">'C'</span>],aggfunc=np.sum)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="3" halign="left">D</th>
    </tr>
    <tr>
      <th></th>
      <th>C</th>
      <th>large</th>
      <th>medium</th>
      <th>small</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bar</th>
      <th>three</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">foo</th>
      <th>one</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>two</th>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="对数据使用函数"><a href="#对数据使用函数" class="headerlink" title="对数据使用函数"></a>对数据使用函数</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>,<span class="number">5</span>),columns=list(<span class="string">'ABCDE'</span>))</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.411040</td>
      <td>0.192597</td>
      <td>0.498276</td>
      <td>0.629785</td>
      <td>0.619616</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.845691</td>
      <td>0.510586</td>
      <td>0.299651</td>
      <td>0.998108</td>
      <td>0.304747</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.623651</td>
      <td>0.208694</td>
      <td>0.756371</td>
      <td>0.460918</td>
      <td>0.648548</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.345734</td>
      <td>0.498705</td>
      <td>0.809781</td>
      <td>0.584406</td>
      <td>0.679397</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.131337</td>
      <td>0.700264</td>
      <td>0.274539</td>
      <td>0.606103</td>
      <td>0.509637</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.849646</td>
      <td>0.230177</td>
      <td>0.805004</td>
      <td>0.407902</td>
      <td>0.625412</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.754866</td>
      <td>0.470509</td>
      <td>0.944374</td>
      <td>0.740570</td>
      <td>0.605332</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.179676</td>
      <td>0.956882</td>
      <td>0.886308</td>
      <td>0.038653</td>
      <td>0.694814</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.197512</td>
      <td>0.464496</td>
      <td>0.476800</td>
      <td>0.682217</td>
      <td>0.345192</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.215948</td>
      <td>0.092079</td>
      <td>0.023335</td>
      <td>0.246493</td>
      <td>0.971298</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="对每一列使用函数"><a href="#对每一列使用函数" class="headerlink" title="对每一列使用函数"></a>对每一列使用函数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(np.mean)</span><br></pre></td></tr></table></figure></div>
<pre><code>A    0.455510
B    0.432499
C    0.577444
D    0.539515
E    0.600399
dtype: float64
</code></pre><h3 id="对每一行使用函数"><a href="#对每一行使用函数" class="headerlink" title="对每一行使用函数"></a>对每一行使用函数</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(np.mean, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0    0.470263
1    0.591757
2    0.539636
3    0.583605
4    0.444376
5    0.583628
6    0.703130
7    0.551267
8    0.433243
9    0.309831
dtype: float64
</code></pre><h2 id="数据的连接-组合-插入"><a href="#数据的连接-组合-插入" class="headerlink" title="数据的连接, 组合, 插入"></a>数据的连接, 组合, 插入</h2><h3 id="末尾拼接两个dataframe"><a href="#末尾拼接两个dataframe" class="headerlink" title="末尾拼接两个dataframe"></a>末尾拼接两个dataframe</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>, <span class="string">'A2'</span>, <span class="string">'A3'</span>],</span><br><span class="line">                    <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>],</span><br><span class="line">                    <span class="string">'C'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>, <span class="string">'C2'</span>, <span class="string">'C3'</span>],</span><br><span class="line">                    <span class="string">'D'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>, <span class="string">'D2'</span>, <span class="string">'D3'</span>]&#125;,</span><br><span class="line">                   index=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A4'</span>, <span class="string">'A5'</span>, <span class="string">'A6'</span>, <span class="string">'A7'</span>],</span><br><span class="line">                    <span class="string">'B'</span>: [<span class="string">'B4'</span>, <span class="string">'B5'</span>, <span class="string">'B6'</span>, <span class="string">'B7'</span>],</span><br><span class="line">                    <span class="string">'C'</span>: [<span class="string">'C4'</span>, <span class="string">'C5'</span>, <span class="string">'C6'</span>, <span class="string">'C7'</span>],</span><br><span class="line">                    <span class="string">'D'</span>: [<span class="string">'D4'</span>, <span class="string">'D5'</span>, <span class="string">'D6'</span>, <span class="string">'D7'</span>]&#125;,</span><br><span class="line">                   index=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div>
<p>append只能拼接行</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.append(df2)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div>
<p>concat可以拼接列以及行,要注意index和column的重复</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df1,df2],axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df1,df2],axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="按loc末尾直接加入行或列"><a href="#按loc末尾直接加入行或列" class="headerlink" title="按loc末尾直接加入行或列"></a>按loc末尾直接加入行或列</h3><p>按loc大法只能拼一列或者一行到末尾</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1.loc[<span class="number">5</span>] = list(<span class="string">'EFGH'</span>)</span><br><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>E</td>
      <td>F</td>
      <td>G</td>
      <td>H</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1.loc[:,<span class="string">'E'</span>] = list(<span class="string">'EFGHI'</span>)</span><br><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>E</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>F</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>G</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>H</td>
    </tr>
    <tr>
      <th>5</th>
      <td>E</td>
      <td>F</td>
      <td>G</td>
      <td>H</td>
      <td>I</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="两个dafaframe组合"><a href="#两个dafaframe组合" class="headerlink" title="两个dafaframe组合"></a>两个dafaframe组合</h3><p>df1.join(df2)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>, <span class="string">'A2'</span>, <span class="string">'A3'</span>],           </span><br><span class="line">                     <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>]&#125;,</span><br><span class="line">                     index=[<span class="string">'K0'</span>, <span class="string">'K1'</span>, <span class="string">'K0'</span>, <span class="string">'K1'</span>])</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">'C'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>],</span><br><span class="line">                      <span class="string">'D'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>]&#125;,</span><br><span class="line">                     index=[<span class="string">'K0'</span>, <span class="string">'K1'</span>])</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.join(df2)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>K0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K0</th>
      <td>A2</td>
      <td>B2</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>K1</th>
      <td>A3</td>
      <td>B3</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="插入特定行"><a href="#插入特定行" class="headerlink" title="插入特定行"></a>插入特定行</h3><p>特定的行插入一个dataframe</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>, <span class="string">'A2'</span>, <span class="string">'A3'</span>],           </span><br><span class="line">                     <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>]&#125;)</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>],</span><br><span class="line">                      <span class="string">'B'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>]&#125;)</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df2</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>
<p>定义一个在第n行后插入dataframe的函数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_row</span><span class="params">(idx, df, df_insert)</span>:</span></span><br><span class="line">    dfA = df.iloc[:idx, ]</span><br><span class="line">    dfB = df.iloc[idx:, ]</span><br><span class="line"></span><br><span class="line">    df = dfA.append(df_insert).append(dfB)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> df</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1_inserted = insert_row(<span class="number">2</span>, df1, df2)</span><br><span class="line">df1_inserted</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="插入特定列"><a href="#插入特定列" class="headerlink" title="插入特定列"></a>插入特定列</h3><p>自带函数df.insert可在第n列插入一列新的数据</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D</td>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.insert(<span class="number">1</span>,<span class="string">'D'</span>, list(<span class="string">'ABCD'</span>))</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>A</td>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>B</td>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>C</td>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D</td>
      <td>D</td>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
<p>如果要在特定位置插入多列数据只能用这个</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_column</span><span class="params">(idx, df, df_insert)</span>:</span></span><br><span class="line">    dfA = df.iloc[:,:idx]</span><br><span class="line">    dfB = df.iloc[:,idx:]</span><br><span class="line"></span><br><span class="line">    df = pd.concat([pd.concat([dfA, df_insert], axis=<span class="number">1</span>),dfB], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> df</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>, <span class="string">'A2'</span>, <span class="string">'A3'</span>],           </span><br><span class="line">                     <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>],</span><br><span class="line">                      <span class="string">'C'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>]&#125;)</span><br><span class="line">   </span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">'D'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>],</span><br><span class="line">                    <span class="string">'E'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>]&#125;)</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert_column(<span class="number">1</span>, df1, df2)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
      <th>E</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>B0</td>
      <td>B0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>B1</td>
      <td>B1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>B2</td>
      <td>B2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>B3</td>
      <td>B3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="利用groupby和条件增加列"><a href="#利用groupby和条件增加列" class="headerlink" title="利用groupby和条件增加列"></a>利用groupby和条件增加列</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:np.array([<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'bar'</span>,<span class="string">'bar'</span>]),</span><br><span class="line">      <span class="string">'B'</span>:np.array([<span class="string">'one'</span>,<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'three'</span>]),</span><br><span class="line">     <span class="string">'C'</span>:np.array([<span class="string">'small'</span>,<span class="string">'medium'</span>,<span class="string">'large'</span>,<span class="string">'large'</span>,<span class="string">'small'</span>,<span class="string">'small'</span>]),</span><br><span class="line">     <span class="string">'D'</span>:np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>])&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>small</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>medium</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(df)</span>:</span></span><br><span class="line">    df[<span class="string">'D_sum'</span>] = df[<span class="string">'D'</span>].sum()</span><br><span class="line">    <span class="keyword">return</span> df</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">'D'</span>).apply(func)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>D_sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>small</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>medium</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>5</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="利用apply函数增加列"><a href="#利用apply函数增加列" class="headerlink" title="利用apply函数增加列"></a>利用apply函数增加列</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:np.array([<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'foo'</span>,<span class="string">'bar'</span>,<span class="string">'bar'</span>]),</span><br><span class="line">      <span class="string">'B'</span>:np.array([<span class="string">'one'</span>,<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'three'</span>]),</span><br><span class="line">     <span class="string">'C'</span>:np.array([<span class="string">'small'</span>,<span class="string">'medium'</span>,<span class="string">'large'</span>,<span class="string">'large'</span>,<span class="string">'small'</span>,<span class="string">'small'</span>]),</span><br><span class="line">     <span class="string">'D'</span>:np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>])&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>small</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>medium</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> a==<span class="string">'foo'</span> <span class="keyword">else</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(<span class="keyword">lambda</span> column: func(column[<span class="string">'A'</span>], column[<span class="string">'B'</span>]), axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0    1
1    1
2    1
3    1
4    0
5    0
dtype: int64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(df)</span>:</span></span><br><span class="line">    df[<span class="string">'A_equal_foo'</span>] = <span class="number">1</span> <span class="keyword">if</span> df[<span class="string">'A'</span>]==<span class="string">'foo'</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> df</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.apply(func, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>A_equal_foo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>small</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>one</td>
      <td>medium</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>two</td>
      <td>large</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>three</td>
      <td>small</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="database式merge数据"><a href="#database式merge数据" class="headerlink" title="database式merge数据"></a>database式merge数据</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df1 = pd.DataFrame(&#123;<span class="string">'lkey'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'foo'</span>],</span><br><span class="line"><span class="meta">... </span>                    <span class="string">'value'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df2 = pd.DataFrame(&#123;<span class="string">'rkey'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'foo'</span>],</span><br><span class="line"><span class="meta">... </span>                    <span class="string">'value'</span>: [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]&#125;)</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.merge(df2, on=<span class="string">'value'</span>,how=<span class="string">'inner'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lkey</th>
      <th>value</th>
      <th>rkey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.merge(df2, on=<span class="string">'value'</span>,how=<span class="string">'outer'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lkey</th>
      <th>value</th>
      <th>rkey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baz</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>6</td>
      <td>bar</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>7</td>
      <td>baz</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>8</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.merge(df2, left_on=<span class="string">'value'</span>, right_on=<span class="string">'value'</span>,how=<span class="string">'inner'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lkey</th>
      <th>value</th>
      <th>rkey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.merge(df2, left_on=<span class="string">'value'</span>, right_on=<span class="string">'value'</span>,how=<span class="string">'outer'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lkey</th>
      <th>value</th>
      <th>rkey</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>baz</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>6</td>
      <td>bar</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>7</td>
      <td>baz</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>8</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.merge(df2, left_on=<span class="string">'lkey'</span>, right_on=<span class="string">'rkey'</span>)</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lkey</th>
      <th>value_x</th>
      <th>rkey</th>
      <th>value_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>foo</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>1</td>
      <td>foo</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>2</td>
      <td>bar</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>baz</td>
      <td>3</td>
      <td>baz</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df1.merge(df2, left_on=<span class="string">'lkey'</span>, right_on=<span class="string">'rkey'</span>, suffixes=(<span class="string">'_left'</span>, <span class="string">'_right'</span>))</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lkey</th>
      <th>value_left</th>
      <th>rkey</th>
      <th>value_right</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>foo</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>1</td>
      <td>foo</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>5</td>
      <td>foo</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bar</td>
      <td>2</td>
      <td>bar</td>
      <td>6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>baz</td>
      <td>3</td>
      <td>baz</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="数据统计"><a href="#数据统计" class="headerlink" title="数据统计"></a>数据统计</h2><h3 id="基本统计"><a href="#基本统计" class="headerlink" title="基本统计"></a>基本统计</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(np.random.rand(<span class="number">10</span>,<span class="number">5</span>),columns=list(<span class="string">'ABCDE'</span>))</span><br><span class="line">df.describe()</span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.548176</td>
      <td>0.581951</td>
      <td>0.492730</td>
      <td>0.362844</td>
      <td>0.464692</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.269487</td>
      <td>0.296894</td>
      <td>0.344442</td>
      <td>0.314646</td>
      <td>0.205078</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.139214</td>
      <td>0.152646</td>
      <td>0.032955</td>
      <td>0.003880</td>
      <td>0.142789</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.328505</td>
      <td>0.284380</td>
      <td>0.224993</td>
      <td>0.093924</td>
      <td>0.339452</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.597528</td>
      <td>0.747586</td>
      <td>0.538701</td>
      <td>0.325856</td>
      <td>0.453823</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.715508</td>
      <td>0.819579</td>
      <td>0.799554</td>
      <td>0.563304</td>
      <td>0.653605</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.964156</td>
      <td>0.871106</td>
      <td>0.920916</td>
      <td>0.841107</td>
      <td>0.703043</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.mean() <span class="comment"># 得到数据框df中每一列的平均值</span></span><br></pre></td></tr></table></figure></div>
<pre><code>A    0.548176
B    0.581951
C    0.492730
D    0.362844
E    0.464692
dtype: float64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.corr() <span class="comment"># 得到数据框df中每一列与其他列的相关系数</span></span><br></pre></td></tr></table></figure></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1.000000</td>
      <td>0.097622</td>
      <td>-0.571543</td>
      <td>0.364524</td>
      <td>-0.083053</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.097622</td>
      <td>1.000000</td>
      <td>-0.058487</td>
      <td>-0.347005</td>
      <td>-0.603136</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-0.571543</td>
      <td>-0.058487</td>
      <td>1.000000</td>
      <td>-0.369241</td>
      <td>0.222586</td>
    </tr>
    <tr>
      <th>D</th>
      <td>0.364524</td>
      <td>-0.347005</td>
      <td>-0.369241</td>
      <td>1.000000</td>
      <td>0.232339</td>
    </tr>
    <tr>
      <th>E</th>
      <td>-0.083053</td>
      <td>-0.603136</td>
      <td>0.222586</td>
      <td>0.232339</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.count() <span class="comment"># 得到数据框df中每一列的非空值个数</span></span><br></pre></td></tr></table></figure></div>
<pre><code>A    10
B    10
C    10
D    10
E    10
dtype: int64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.max() <span class="comment"># 得到数据框df中每一列的最大值</span></span><br></pre></td></tr></table></figure></div>
<pre><code>A    0.964156
B    0.871106
C    0.920916
D    0.841107
E    0.703043
dtype: float64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.min() <span class="comment"># 得到数据框df中每一列的最小值</span></span><br></pre></td></tr></table></figure></div>
<pre><code>A    0.139214
B    0.152646
C    0.032955
D    0.003880
E    0.142789
dtype: float64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.median() <span class="comment"># 得到数据框df中每一列的中位数</span></span><br></pre></td></tr></table></figure></div>
<pre><code>A    0.597528
B    0.747586
C    0.538701
D    0.325856
E    0.453823
dtype: float64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.std() <span class="comment"># 得到数据框df中每一列的标准差</span></span><br></pre></td></tr></table></figure></div>
<pre><code>A    0.269487
B    0.296894
C    0.344442
D    0.314646
E    0.205078
dtype: float64
</code></pre><p>对所有值进行描述统计</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.stack().std(ddof=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0.2882311219915606
</code></pre><p>numpy求法, ddof是degree of freedom</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.values.std(ddof=<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0.2882311219915606
</code></pre><h3 id="最大值索引"><a href="#最大值索引" class="headerlink" title="最大值索引"></a>最大值索引</h3><p>每一列的最大值的索引</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.idxmax()</span><br></pre></td></tr></table></figure></div>
<pre><code>A    8
B    3
C    2
D    1
E    9
dtype: int64
</code></pre><h2 id="时间序列"><a href="#时间序列" class="headerlink" title="时间序列"></a>时间序列</h2><h3 id="构建时间索引"><a href="#构建时间索引" class="headerlink" title="构建时间索引"></a>构建时间索引</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i = pd.date_range(<span class="string">'20000101'</span>,periods=<span class="number">100</span>)</span><br><span class="line">i[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;,
               &#39;2000-01-05&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i.year[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>Int64Index([2000, 2000, 2000, 2000, 2000], dtype=&#39;int64&#39;)
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i.day[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>Int64Index([1, 2, 3, 4, 5], dtype=&#39;int64&#39;)
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i.month[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure></div>
<pre><code>Int64Index([1, 1, 1, 1, 1], dtype=&#39;int64&#39;)
</code></pre><h3 id="转换时间格式"><a href="#转换时间格式" class="headerlink" title="转换时间格式"></a>转换时间格式</h3><p>通过整数序列来转换时间序列</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>i = pd.date_range(<span class="string">'20000101'</span>,periods=<span class="number">100</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(dict(year = i.year, month = i.month, day = i.day))</span><br><span class="line">time_series = df.year*<span class="number">10000</span> + df.month*<span class="number">100</span> + df.day</span><br><span class="line">time_series</span><br></pre></td></tr></table></figure></div>
<pre><code>0     20000101
1     20000102
2     20000103
3     20000104
4     20000105
        ...   
95    20000405
96    20000406
97    20000407
98    20000408
99    20000409
Length: 100, dtype: int64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.to_datetime(time_series, format=<span class="string">'%Y%m%d'</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0    2000-01-01
1    2000-01-02
2    2000-01-03
3    2000-01-04
4    2000-01-05
        ...    
95   2000-04-05
96   2000-04-06
97   2000-04-07
98   2000-04-08
99   2000-04-09
Length: 100, dtype: datetime64[ns]
</code></pre><p>通过String来转换时间序列</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = df.astype(str)</span><br><span class="line">time_string = df.day + df.month + df.year</span><br><span class="line">time_string</span><br></pre></td></tr></table></figure></div>
<pre><code>0     112000
1     212000
2     312000
3     412000
4     512000
       ...  
95    542000
96    642000
97    742000
98    842000
99    942000
Length: 100, dtype: object
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.to_datetime(time_string, format=<span class="string">"%d%m%Y"</span>)</span><br></pre></td></tr></table></figure></div>
<pre><code>0    2000-01-01
1    2000-01-02
2    2000-01-03
3    2000-01-04
4    2000-01-05
        ...    
95   2000-04-05
96   2000-04-06
97   2000-04-07
98   2000-04-08
99   2000-04-09
Length: 100, dtype: datetime64[ns]
</code></pre><h3 id="时间格式采样"><a href="#时间格式采样" class="headerlink" title="时间格式采样"></a>时间格式采样</h3><p><strong>时间频率如下</strong></p>
<p>B       business day frequency<br>C       custom business day frequency (experimental)<br>D       calendar day frequency<br>W       weekly frequency<br>M       month end frequency<br>BM      business month end frequency<br>CBM     custom business month end frequency<br>MS      month start frequency<br>BMS     business month start frequency<br>CBMS    custom business month start frequency<br>Q       quarter end frequency<br>BQ      business quarter endfrequency<br>QS      quarter start frequency<br>BQS     business quarter start frequency<br>A       year end frequency<br>BA      business year end frequency<br>AS      year start frequency<br>BAS     business year start frequency<br>BH      business hour frequency<br>H       hourly frequency<br>T       minutely frequency<br>S       secondly frequency<br>L       milliseonds<br>U       microseconds<br>N       nanoseconds</p>
<p>原文链接：<a href="https://blog.csdn.net/qq_41996090/article/details/87555618" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_41996090/article/details/87555618</a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index = pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">9</span>, freq=<span class="string">'T'</span>)</span><br><span class="line">series = pd.Series(range(<span class="number">9</span>), index=index)</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series</span><br></pre></td></tr></table></figure></div>
<pre><code>2000-01-01 00:00:00    0
2000-01-01 00:01:00    1
2000-01-01 00:02:00    2
2000-01-01 00:03:00    3
2000-01-01 00:04:00    4
2000-01-01 00:05:00    5
2000-01-01 00:06:00    6
2000-01-01 00:07:00    7
2000-01-01 00:08:00    8
Freq: T, dtype: int64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.resample(<span class="string">'3T'</span>).sum()</span><br></pre></td></tr></table></figure></div>
<pre><code>2000-01-01 00:00:00     3
2000-01-01 00:03:00    12
2000-01-01 00:06:00    21
Freq: 3T, dtype: int64
</code></pre><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.resample(<span class="string">'3T'</span>, label=<span class="string">'right'</span>, closed=<span class="string">'right'</span>).sum()</span><br></pre></td></tr></table></figure></div>
<pre><code>2000-01-01 00:00:00     0
2000-01-01 00:03:00     6
2000-01-01 00:06:00    15
2000-01-01 00:09:00    15
Freq: 3T, dtype: int64
</code></pre><p>采样的频率</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.resample(<span class="string">'10S'</span>).asfreq().head()</span><br></pre></td></tr></table></figure></div>
<pre><code>2000-01-01 00:00:00    0.0
2000-01-01 00:00:10    NaN
2000-01-01 00:00:20    NaN
2000-01-01 00:00:30    NaN
2000-01-01 00:00:40    NaN
Freq: 10S, dtype: float64
</code></pre><p>自定义函数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">custom_resampler</span><span class="params">(array_like)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> np.sum(array_like) + <span class="number">5</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">series.resample(<span class="string">'3T'</span>).apply(custom_resampler)</span><br></pre></td></tr></table></figure></div>
<pre><code>2000-01-01 00:00:00     8
2000-01-01 00:03:00    17
2000-01-01 00:06:00    26
Freq: 3T, dtype: int64
</code></pre></div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python    </a><a class="post-meta__tags" href="/tags/pandas/">pandas    </a><a class="post-meta__tags" href="/tags/kesci/">kesci    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/01/15/python/basics/pandas_datetime_notes/"><img class="prev_cover lazyload" data-src="http://q3zyvka9r.bkt.gdipper.com/20200116144530.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>pandas datetime notes</span></div></a></div><div class="next-post pull_right"><a href="/2020/01/14/random_notes/windows_10_tricks/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104331.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>windows_10_tricks.md</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/01/15/python/kesci_notes/pandas10套练习/" title="pandas 10套练习"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-15</div><div class="relatedPosts_title">pandas 10套练习</div></div></a></div><div class="relatedPosts_item"><a href="/2020/02/16/python/advanced/class_instances_to_dataframe/" title="class_instances_to_dataframe"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200201165020.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-02-16</div><div class="relatedPosts_title">class_instances_to_dataframe</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/15/python/basics/pandas_datetime_notes/" title="pandas datetime notes"><img class="relatedPosts_cover lazyload" data-src="http://q3zyvka9r.bkt.gdipper.com/20200116144530.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-15</div><div class="relatedPosts_title">pandas datetime notes</div></div></a></div><div class="relatedPosts_item"><a href="/2019/04/02/python/basics/pandas_useful_websites/" title="pandas_useful_websites"><img class="relatedPosts_cover lazyload" data-src="http://q3zyvka9r.bkt.gdipper.com/20200116144530.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-04-02</div><div class="relatedPosts_title">pandas_useful_websites</div></div></a></div><div class="relatedPosts_item"><a href="/2018/12/04/python/basics/pandas_frame_creation_and_insertion/" title="pandas frame creation and insertion"><img class="relatedPosts_cover lazyload" data-src="http://q3zyvka9r.bkt.gdipper.com/20200116144530.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-12-04</div><div class="relatedPosts_title">pandas frame creation and insertion</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/25/python/kesci_notes/numpy基础命令速查表/" title="numpy 基础命令速查表"><img class="relatedPosts_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-25</div><div class="relatedPosts_title">numpy 基础命令速查表</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xvMxbws16Erd8WUfqxkvHmb5-gzGzoHsz',
  appKey:'4U0Vo7NQIUL0eJzHdkPzdCDr',
  placeholder:'不说话的人会疯掉吗?',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/supersheepbear/blog_source@master/blog/image/20200202104250.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By supersheepbear</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="external nofollow noopener noreferrer"><span>Butterfly</span></a></div><div class="footer_custom_text">外向孤独者患者</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script id="canvas_nest" color="255,240,245" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="external nofollow noopener noreferrer" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>